# Website

This website is built using [Docusaurus 2](https://docusaurus.io/), a modern static website generator.

### Installation

```
$ yarn
```

### Local Development

```
$ yarn start
```

This command starts a local development server and opens up a browser window. Most changes are reflected live without having to restart the server.

### Build

```
$ yarn build
```

This command generates static content into the `build` directory and can be served using any static contents hosting service.

### Deployment

Using SSH:

```
$ USE_SSH=true yarn deploy
```

Not using SSH:

```
$ GIT_USER=<Your GitHub username> yarn deploy
```

If you are using GitHub pages for hosting, this command is a convenient way to build the website and push to the `gh-pages` branch.


# How algolia search is set up
The docusaurus has support for [algolia](https://www.algolia.com/) out of the box.
The config for the search is found in the [docusaurus.config.js](https://github.com/equinor/dm-docs/blob/main/docs/docusaurus.config.js).

An extra attribute called `algolia`  under `themeConfig` needs to be added with some attributes
* appId = id for the application registered with algolia. 
* apiKey = the api key with only search access. This is safe to commit to the repo. 
* indexName = the name of the index to use to find search results. 

To create an application with algolia, you need to send in an [application](https://docsearch.algolia.com/apply/).
To manage the algolia application, you can log in through https://dashboard.algolia.com/. Here you can see indices for the application, create new API keys, etc.

## How to generate a new index manually
The search functionality is based on an index generated by algolia. Algolia will create a new index regularly, but you can also generate it manually:

1) create a new .env file and paste in an API key with permissions: addObject, DeleteIndex and editSettings (this key is defined in the algolia dashboard)
2) run the script `run-indexing-for-search.sh`